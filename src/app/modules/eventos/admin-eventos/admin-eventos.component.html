
<div class="row text-center mt-4 col-md-2">
  <div class="btn-group">
    <div class="btn btn-primary"  (click)="activeViewMes()" [class.active]="activeMes === true">Mes</div>
    <div class="btn btn-primary"  (click)="activeViewYear()" [class.active]="activeYear === true">Año</div>
    <!--<div class="btn btn-primary" (click)="setView(CalendarView.Week)" [class.active]="view === CalendarView.Week">Semana</div>
    <div class="btn btn-primary" (click)="setView(CalendarView.Day)" [class.active]="view === CalendarView.Day">Día</div>-->
  </div>
</div>
    <div *ngIf="activeMes">
      <div class="row text-center mt-4">
        <div class="col-md-9">
          <h3>{{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}</h3>
        </div>
        <div class="col-md-3">
          <div class="btn-group">
            <div class="btn btn-primary" mwlCalendarPreviousView [view]="view" [(viewDate)]="viewDate" (viewDateChange)="closeOpenMonthViewDay()">
              <label>Anterior</label>
            </div>
            <div class="btn btn-outline-secondary" mwlCalendarToday [(viewDate)]="viewDate">
              Hoy
            </div>
            <div class="btn btn-primary" mwlCalendarNextView [view]="view" [(viewDate)]="viewDate" (viewDateChange)="closeOpenMonthViewDay()">
              <label>Siguiente</label>
            </div>
          </div>
        </div>
      </div>
      <br />
      <div [ngSwitch]="view">
        <mwl-calendar-month-view
          *ngSwitchCase="CalendarView.Month"
          [viewDate]="viewDate"
          [events]="events"
          [refresh]="refresh"
          [activeDayIsOpen]="activeDayIsOpen"
          (dayClicked)="dayClicked($event.day)"
          (eventClicked)="handleEvent('Clicked', $event.event)"
          (eventTimesChanged)="eventTimesChanged($event)"
        >
        </mwl-calendar-month-view>
        <mwl-calendar-week-view
          *ngSwitchCase="CalendarView.Week"
          [viewDate]="viewDate"
          [events]="events"
          [refresh]="refresh"
          (eventClicked)="handleEvent('Clicked', $event.event)"
          (eventTimesChanged)="eventTimesChanged($event)"
        >
        </mwl-calendar-week-view>
        <mwl-calendar-day-view
          *ngSwitchCase="CalendarView.Day"
          [viewDate]="viewDate"
          [events]="events"
          [refresh]="refresh"
          (eventClicked)="handleEvent('Clicked', $event.event)"
          (eventTimesChanged)="eventTimesChanged($event)"
        >
        </mwl-calendar-day-view>
      </div>
    </div>   
    <div *ngIf="activeYear">
      <div class="row text-center mt-4">
        <div class="col-md-9">
          <h3> Año {{this.year}}</h3>
        </div>
        <div class="col-md-3">
          <div class="btn-group">
            <div class="btn btn-primary" (click)="beforeYear()">
              <label>Anterior</label>
            </div>
            <div class="btn btn-outline-secondary" (click) ="activeViewYear()">
              Hoy
            </div>
            <div class="btn btn-primary" (click)="nextYear()">
              <label>Siguiente</label>
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-md-4"  *ngFor="let meses of listaMesesYear">
          <h3 class="mt-2">{{meses.mes}}</h3>
          <div class="table-responsive" style="height: 337px; border-radius:12px; background-color:{{meses.color}}">
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th *ngFor="let titulo of meses.titulosDias" style=" background-color: rgb(232, 235, 235);" >{{titulo}}</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let dias of meses.semanas">
                  <td *ngFor="let day of dias" (click)="eventosPorDia(day)" style=" background-color:{{day.color}}">
                    {{day.dia}}
                    <div *ngIf="day.eventos != ''"  class="estiloCantidadEventos">{{day.eventos}}</div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div> 
        </div>
      </div>
      
    </div>
    <!-- Everything you see below is just for the demo, you don't need to include it in your app -->
    
    <br /><br /><br />


  <ng-template #modalContent let-modal>
  <div class="modal-header backgroundHeaderPopUp">
      <h4 class="modal-title colorIconsHeader" id="modal-basic-title">{{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}</h4>
      <span aria-hidden="true" (click)="modal.dismiss('Cross click'); consultarEventos()"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-x-circle-fill colorIconsHeader" viewBox="0 0 16 16">
        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
      </svg></span>
  </div>
  <div class="modal-body">
    <h3>Administrar Eventos</h3>
    <div id="mensaje" *ngIf="isShown" class="row m-2 alert alert-primary alert-dismissible">
      <strong class="col-md-3">Operación Exitosa!</strong> <span class="col-md-8">{{mensaje}}</span>
      <span (click)="ocultarMensaje()" class="col-md-1"><a class="close" data-dismiss="alert" aria-label="close">&times;</a></span>
    </div> 
    <div id="mensajeError" *ngIf="isShownErr" class="row m-2 alert alert-danger alert-dismissible">
      <strong class="col-md-3">Error en la Operación!</strong> <span class="col-md-8">{{mensaje}}</span>
      <span (click)="ocultarMensaje()" class="col-md-1"><a class="close" data-dismiss="alert" aria-label="close">&times;</a></span>
    </div>   
      <div class="clearfix"></div>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title"></h4>
        <span aria-hidden="true" (click)="addEvent()"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-plus-square-fill colorIcons" viewBox="0 0 16 16">
          <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm6.5 4.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3a.5.5 0 0 1 1 0z"/>
        </svg></span>
      </div>												
      <div class="table-responsive">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Evento</th>
              <th>Inicio</th>
              <th>Fin</th>
              <th>Tipo Evento</th>
              <th>Color</th>
              <th>Guardar</th>
              <th>Eliminar</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let event of eventsFilter">
              <td>
                <input [(ngModel)]="event.title" type="text" class="form-control"  name="title" placeholder="Ingrese un evento"/>
              </td>
              <td>
                <input [(ngModel)]="event.start" type="text" class="form-control"  name="fechaIncio" mwlFlatpickr  (ngModelChange)="refresh.next()" [altInput]="true" [convertModelValue]="true" [enableTime]="true" dateFormat="Y-m-dTH:i" altFormat="F j, Y H:i"  placeholder="Not set"/>
              </td>
              <td>
                <input [(ngModel)]="event.end"  type="text" class="form-control"  name="fechaFin" mwlFlatpickr (ngModelChange)="refresh.next()" [altInput]="true" [convertModelValue]="true" [enableTime]="true" dateFormat="Y-m-dTH:i" altFormat="F j, Y H:i" placeholder="Not set"/>
              </td>
              <td> 
                <select class="form-control" id="tipoEvento_{{event.id}}">   
                  <option>Seleccione</option>  
                  <option *ngFor="let tipoEvento of tiposEventos" [ngValue]="tipoEvento.tipo_evento_id"  [selected]="tipoEvento.tipo_evento_id == event.tipoEvento">{{tipoEvento.nombre}}</option>  
              </select>  
              </td>
              <td>
                <input [(ngModel)]="event.color!.primary" type="color"  name="color" />
              </td>
              <td>
                <span aria-hidden="true" (click)="createUpdateEvent(event)">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-save colorIcons" viewBox="0 0 16 16">
                    <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
                  </svg>
                </span>
              </td>
              <td>
                <span aria-hidden="true" (click)="deleteEvent(event)">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-trash colorIcons" viewBox="0 0 16 16">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                    <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                  </svg>
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div> 
  </div>
  <div class="modal-footer">
  </div>
  </ng-template>
